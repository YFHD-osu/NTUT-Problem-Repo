{
  "uuid": "cf4f0732-21fb-41ca-bf65-0fead6ef4359",
  "title": "33. 邏輯電路圖",
  "createDate": 1748188740000,
  "collections": [
    "3e78a29a-20d2-49c6-8f99-25d7491caebd"
  ],
  "problem": [
    "請設計一個邏輯電路模擬器，模擬由各種邏輯閘（AND、OR、NOT 等）所構成的電路，根據輸入值與邏輯閘的種類計算最終的輸出值。",
    "",
    "本題需依照下列程式架構撰寫，否則不予計分。",
    "",
    "輸入的邏輯閘種類代號如下：",
    "N：NOT Gate",
    "B：BUFFER Gate",
    "A：AND Gate",
    "O：OR Gate",
    "NA：NAND Gate",
    "NO：NOR Gate",
    "",
    "所有輸入與中間運算皆以「3 位元」為單位進行處理，任何 NOT 或邏輯運算後的結果，僅保留其最低 3 位元（0~7）。",
    "例如：",
    "",
    "NOT(0) = ~000 = 111 = 7",
    "",
    "NOT(5) = ~101 = 010 = 2",
    "",
    "程式設計規範：",
    "解題時可針對範例的架構程式碼做修改，但需符合以下三點：",
    "1. #define中必須定義函數指標，函數的參數可自行決定",
    "2. 有定義struct，且當中有使用到第一點的define",
    "3. 使用struct的函數指標進行本題的實作",
    "",
    "#define GATEVALUE(Gate) int(*GateValue)()",
    "typedef struct _Gate {",
    "int input1;",
    "int input2;",
    "GATEVALUE(Gate);",
    "}Gate;",
    "int GateORValue(Gate *gate) {",
    "...",
    "}",
    "int GateANDValue(Gate *gate) {",
    "...",
    "}",
    "int GateNOTValue(Gate *gate) {",
    "...",
    "}",
    "int GateBUFFERValue(Gate *gate) {",
    "...",
    "}",
    "void CreateGate(Gate *obj, char type, int input1, int input2) {",
    "...",
    "}",
    "",
    "<img src='https://edu.filexl.com/uploads/curcuit-diagram.png'>",
    "",
    "【輸入說明】",
    "第一行：輸入三個整數，代表X1, X2, X3的數值，中間以空白隔開(範圍:0~7)",
    "第二行：輸入字串，中間以空白隔開，說明如下：",
    "1.\tX1 的處理方式：N 表示 NOT，B 表示 BUFFER（直接輸出）",
    "",
    "2.\tX2 的處理方式：同上",
    "",
    "3.\tX3 的處理方式：同上",
    "",
    "4.\t第一組邏輯閘（對處理後的 X1 與 X2 做運算，產生中間變數 Y）",
    "",
    "5.\t第二組邏輯閘（對 Y 與處理後的 X3 做運算，產生最終輸出）",
    "",
    "範例說明:",
    "Sample Input:",
    "0 1 2 (X1, X2, X3)",
    "N B B O A (X1 invert, X2, X3, X1 invert 與X2做OR運算得出Y, Y與X3做AND運算)",
    "",
    "X1 = 0 → NOT → 7",
    "",
    "X2 = 1 → BUFFER → 1",
    "",
    "Y = 7 OR 1 = 7",
    "",
    "X3 = 2 → BUFFER → 2",
    "",
    "Output = 7 AND 2 = 10 (十進位 2)",
    "",
    "【輸出說明】",
    "輸出計算的Output binary值",
    "",
    "Sample Output:",
    "010"
  ],
  "testcase": {
    "codeType": 1,
    "cases": [
      {
        "input": [
          "0 1 2",
          "N B B O A"
        ],
        "output": [
          "010"
        ]
      },
      {
        "input": [
          "7 4 1",
          "B N B NO NA"
        ],
        "output": [
          "111"
        ]
      },
      {
        "input": [
          "4 3 1",
          "N N N A NO"
        ],
        "output": [
          "001"
        ]
      },
      {
        "input": [
          "2 7 1",
          "B N N NO A"
        ],
        "output": [
          "100"
        ]
      }
    ]
  },
  "sampleCode": [
    "#include <stdio.h>",
    "",
    "#define GATEVALUE(Gate) int (*GateValue)()",
    "",
    "typedef struct _Gate {",
    "  int input1;",
    "  int input2;",
    "  GATEVALUE(Gate);",
    "} Gate;",
    "",
    "int GateORValue(Gate *gate) {",
    "  return (*gate).input1 | (*gate).input2;",
    "}",
    "int GateANDValue(Gate *gate) {",
    "  return (*gate).input1 & (*gate).input2;",
    "}",
    "int GateNOTValue(Gate *gate) {",
    "  return 7 - (gate->input1);",
    "}",
    "int GateBUFFERValue(Gate *gate) {",
    "  return gate->input1;",
    "}",
    "int GateNORValue(Gate *gate) {",
    "  int result = GateORValue(gate);",
    "  Gate tmp = {result, 0, NULL};",
    "  return GateNOTValue(&tmp);",
    "}",
    "int GateNANDValue(Gate *gate) {",
    "  int result = GateANDValue(gate);",
    "  Gate tmp = {result, 0, NULL};",
    "  return GateNOTValue(&tmp);",
    "}",
    "void CreateGate(Gate *obj, char *type, int input1, int input2) {",
    "  obj->input1 = input1;",
    "  obj->input2 = input2;",
    "",
    "  switch (type[0]) {",
    "    case 'B':",
    "      obj->GateValue = (int (*)(void)) GateBUFFERValue;",
    "      break;",
    "",
    "    case 'A':",
    "      obj->GateValue = (int (*)(void)) GateANDValue;",
    "      break;",
    "    ",
    "    case 'O':",
    "      obj->GateValue = (int (*)(void)) GateORValue;",
    "      break;",
    "",
    "    default:",
    "      switch (type[1]) {",
    "        case 'A':",
    "          obj->GateValue = (int (*)(void)) GateNANDValue;",
    "          break;",
    "        ",
    "        case 'O':",
    "          obj->GateValue = (int (*)(void)) GateNORValue;",
    "          break;",
    "        ",
    "        default:",
    "          obj->GateValue = (int (*)(void)) GateNOTValue;",
    "          break;",
    "      }",
    "  }",
    "  ",
    "  return;",
    "}",
    "",
    "int main() {",
    "  int data[3];",
    "  char oper[10][3];",
    "",
    "  Gate gate1, gate2, gate3, gate4, gate5;",
    "",
    "  scanf(\"%d %d %d\", &(data[0]), &(data[1]), &(data[2]));",
    "  getchar();",
    "",
    "  scanf(\"%s %s %s %s %s\", oper[0], oper[1], oper[2], oper[3], oper[4]);",
    "  ",
    "  CreateGate(&gate1, oper[0], data[0], 0);",
    "  CreateGate(&gate2, oper[1], data[1], 0);",
    "  CreateGate(&gate3, oper[2], data[2], 0);",
    "",
    "  ((int (*)(Gate*))gate1.GateValue)(&gate1);",
    "",
    "  // printf(\"G1: %d, G2 %d, G3: %d\\n\", gate1.GateValue(), gate2.GateValue(), gate3.GateValue());",
    "",
    "  CreateGate(&gate4, oper[3], ((int (*)(Gate*))gate1.GateValue)(&gate1), ((int (*)(Gate*))gate2.GateValue)(&gate2));",
    "  CreateGate(&gate5, oper[4], ((int (*)(Gate*))gate3.GateValue)(&gate3), ((int (*)(Gate*))gate4.GateValue)(&gate4));",
    "  int result = ((int (*)(Gate*))gate5.GateValue)(&gate5);",
    "",
    "  for (int i=2; i >= 0; i--)",
    "    printf(\"%d\", (result & (1<<i)) ? 1 : 0);",
    "  ",
    "  printf(\"\\n\");",
    "  return 0;",
    "}"
  ]
}